<!DOCTYPE html>
<html>

<head>
	<meta charset='utf-8'>
	<meta name='viewport' content='width=device-width,initial-scale=1'>
	<title>Настройка точки доступа</title>
	<style type='text/css'>
		body {
			font-family: 'Arial', sans-serif;
		    display: flex;
		    flex-direction: column;
		    justify-content: space-around;
		    align-items: center;
		    min-height: 90vh;
		    background: #ccc;
		}

		.main-form {
			display: inline-block;
		    background: #fff;
		    padding: 20px;
		    margin: 0 auto;
		    text-align: center;
		    border-radius: 5px;
		}

		.main-form__inputs {
			display: flex;
    		justify-content: space-around;
		}

		input {
			margin-top: 10px;
		    border-radius: 2px;
		    border: 2px solid transparent;
		    background-color: #e9e9e9;
		}

		input[type='submit'] {
			font-size: 18px;
    		padding: 5px 10px;
    		cursor: pointer;
		}

		input:hover {
			background-color: #e9e9e9;
		}
	</style>
</head>

<body>
	<div class='main-form'>
		<form class='main-form__form'>
			<h1>Настройка точки доступа</h1>
			<div class='main-form__inputs'>
				<p>Название WiFi (SSID):<br> <input type='text' name='SSID' required value='temp'></p>
				<p>Пароль:<br> <input type='text' name='password' required value='temp'></p>
			</div>
		
			<input type='submit' value='Подключиться к WiFi'>
		</form>
	</div>

	<script type='text/javascript'>
		form = document.querySelector('.main-form__form');
		console.log(form);
		form.addEventListener('submit', function(e) {
		  e.preventDefault();
		  const data = new FormData(form);
		  let GET_URL = (new URLSearchParams(data)).toString();

		  sendAuthData(GET_URL);
		});


		function sendAuthData(getString) {
			var http = new XMLHttpRequest();
			let http_url = '/action?' + getString;
			console.log(http_url);
			http.open('GET', http_url);  // составить асинхронный (по умолчанию true) GET запрос страницы
			http.onreadystatechange = function () {  // обратная связь: отдаёт ответ на запрос
				if (this.readyState == 2) {  // в период, когда запрос уже отправлен, но полный ответ ещё не пришёл, самое время показывать иконку загрузки
					console.log('Waiting for reply...');
				}
				if (this.readyState == 4 && this.status == 200) {  // отследить момент, когда пришёл полный ответ
					console.log('Response: ' + this.responseText);
				  alert(this.responseText);  // this.responseText — ответ в виде текста
				}
			}
			http.send(null);  // отправить запрос
		}
	</script>
</body>
</html>

